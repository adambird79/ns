{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Home","text":""},{"location":"#netsweeper-process","title":"Netsweeper Process","text":""},{"location":"#onboarding-documents","title":"onboarding documents","text":"<ul> <li>Complete the Netsweeper onboarding documentation and send over to the Netsweeper Account Manager</li> </ul>"},{"location":"#netsweeper-webadmin","title":"Netsweeper Webadmin","text":"<ul> <li>Is a Directory Sync required? <ul> <li>Is it an Intune / EntraID deployment - Create EntraID Sync</li> <li>Does the customer have Radius</li> </ul> </li> <li>If no additional complexity create groups in Active Directory and create matching groups in Netsweeper</li> <li>Add Client IP Range(s)</li> <li>Create wagent config</li> <li>Create Client Filter Config</li> <li>Create Reports</li> <li>Create User Accounts for onGuard</li> </ul>"},{"location":"#windows-pre-deployment","title":"Windows Pre-Deployment","text":"<ul> <li>Create the MST file for the wagent</li> <li>Create the MST file for the Client Filter</li> <li>Deploy the SSL certificate</li> </ul> <p>Warning</p> <p>If we are moving from Netsweeper to Netsweeper the wagent and client filter should deployed during the switchover</p> <ul> <li>Create the wagent GPO only if not using Netsweeper already</li> <li>Create the Client Filter GPO</li> <li>Enable the wagent GPO</li> <li>Leave the Client Filter GPO Disabled </li> </ul>"},{"location":"#other-pre-deployment","title":"Other Pre-Deployment","text":"<ul> <li>Deploy the SSL certificate to any other devices IOS, Chromebook, Android etc. </li> </ul>"},{"location":"#deployment","title":"Deployment","text":""},{"location":"#windows-deployment","title":"Windows Deployment","text":"<ul> <li>Deploy the wagent wagent</li> <li>Test the Filtering</li> <li>Deploy the Client Filter Client Filter GPO</li> <li>Test the Monitoring</li> </ul>"},{"location":"#ios-deployment","title":"IOS Deployment","text":"<p>Text here</p>"},{"location":"#chromebook-deployment","title":"Chromebook Deployment","text":"<p>Text here</p>"},{"location":"Android/","title":"Android","text":"","tags":["Android","Google"]},{"location":"Android/#requirements","title":"Requirements","text":"<p>MDM</p> <p>A MDM Solution is required to use the Client Filter on Android</p>","tags":["Android","Google"]},{"location":"Android/#limitations","title":"Limitations","text":"<p>Android devices require a connection to www.google.com to verify internet connectivity, so an Android device going through Netsweeper will report that it has no internet connection</p> <p>The Netsweeper workaround is to add a new CNAME record on your local DNS server for your local Google domain(s) that points to forcesafesearch.google.com</p> <p>Ideally any Android devices would need to be on a separate VLAN due to not inspecting the Google traffic.</p>","tags":["Android","Google"]},{"location":"Android/#mdm-guides","title":"MDM Guides","text":"","tags":["Android","Google"]},{"location":"Android/#intune","title":"Intune","text":"","tags":["Android","Google"]},{"location":"Android/#ssl-certificate","title":"SSL Certificate","text":"","tags":["Android","Google"]},{"location":"Apple/","title":"Apple","text":"<p>The nMonitor app should be purchased from the MDM (this is free). nMonitor is a replacement browser and to ensure monitoring is effective any other browsers should be disabled via the MDM</p> <p>Where a MDM is not in-place we can only install the SSL certificate and enable filtering on the devices, note this would be a manual process adding time to the project.</p>","tags":["Apple","IOS","iPad","MacOS"]},{"location":"Apple/#requirements","title":"Requirements","text":"<p>MDM</p> <p>A MDM Solution is required to use the Client Filter on IOS</p> <p>For the IOS replacement \"Clint Filter\" browser the device must be running IOS 14.0 or later</p> <p></p>","tags":["Apple","IOS","iPad","MacOS"]},{"location":"Apple/#mdm-guides","title":"MDM Guides","text":"","tags":["Apple","IOS","iPad","MacOS"]},{"location":"Apple/#intune","title":"Intune","text":"","tags":["Apple","IOS","iPad","MacOS"]},{"location":"Apple/#ssl-certificate","title":"SSL Certificate","text":"","tags":["Apple","IOS","iPad","MacOS"]},{"location":"Apple/#clint-filter-replacement-browser","title":"Clint Filter (Replacement Browser)","text":"<p>To setup Microsoft Endpoint Manager for you will need to have the client filter plist files prepared already.</p> <p>Login to: Intune Admin </p> <p>Then go to \u201cApps\u201d -&gt; \u201ciOS/iPadOS\u201d</p> <p></p> <p>Then click \u201c+ Add\u201d and then on the new blade select the drop down and \u201ciOS store app\u201d once selected click \u201cSelect\u201d</p> <p></p> <p>On this next screen select \u201cSearch the App Store\u201d</p> <p></p> <p>Search for \u201cNetsweeper\u201d this returns the fewest results</p> <p></p> <p>Once selected you will the following screen</p> <p></p> <p>Click \u201cNext\u201d and the assign to the groups / devices that should be receiving the app. Then on the next screen click \u201cCreate\u201d.</p> <p>Once the App is created, we need to push the configuration out to the App. To do this we need to create a configuration policy in \u201cApp Configuration Policies\u201d.</p> <p>Still under \u201cApps\u201d click the \u201cApp configuration policies\" then click the \u201c+ Add\u201d and select \"Managed Devices.</p> <p></p> <p>On this next page we need to complete the following:</p> <p>Name \u2013 Should be something identifiable (e.g. IOS \u2013 Netsweeper Client Filter \u2013 Pupil)</p> <p>Platform: iOS/iPadOS</p> <p>Targeted app: click \u201cSelect app\u201d and find the \u201cNetsweeper Client Filter\u201d in the list</p> <p></p> <p>The next screen we need to import the plist settings, for \u201cConfiguration settings format\u201d I select \u201cEnter XML data\u201d, now in the box at the bottom we need to enter the XML from the plist, inTune only accepts the XML between the tags  and  as below:</p> <p></p> <p>Click \u201cNext\u201d and assign to the required groups and the under \u201cReview + Create\u201d click \u201cCreate\u201d</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?\\&gt;\n\n&lt;!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\"\n\"http://www.apple.com/DTDs/PropertyList-1.0.dtd\"\\&gt;\n\n&lt;plist version=\"1.0\"\\&gt;\n\n&lt;dict\\&gt;\n\n    &lt;key\\&gt;configedit\\&lt;/key\\&gt;\n\n    &lt;string\\&gt;-p filter.wavenetcloud.netsweeper.com:3431 -y\nnetsweeper_brand -f 958209 -n {{username}} -d DFE-CODE -g nsw_pupil@DFE-CODE -a DFE-CODE -A DFE-CODE&lt;/string\\&gt;\n\n&lt;/dict\\&gt;\n\n&lt;/plist\\&gt;\n</code></pre>","tags":["Apple","IOS","iPad","MacOS"]},{"location":"Apple/#moysle","title":"Moysle","text":"<p><pre><code>&lt;dict&gt;\n    &lt;key&gt;configedit&lt;/key&gt;\n    &lt;string&gt;-p filter.wavenetcloud.netsweeper.com:3431 -y netsweeper_brand -f 958209 -n %DeviceName% -d DFE-CODE -g nsw_pupil -a DFE-CODE -A DFE-CODE&lt;/string&gt;\n&lt;/dict&gt;\n</code></pre> In Mosyle the available variables are shown when you go to create the app configuration, the most useful will be %DeviceName% (make sure no spaces in the name) and %SerialNumber%</p>","tags":["Apple","IOS","iPad","MacOS"]},{"location":"Apple/#jamf","title":"JAMF","text":"","tags":["Apple","IOS","iPad","MacOS"]},{"location":"Apple/#lightspeed","title":"Lightspeed","text":"<p><pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?\\&gt;\n\n&lt;!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\"\n\"http://www.apple.com/DTDs/PropertyList-1.0.dtd\"\\&gt;\n\n&lt;plist version=\"1.0\"\\&gt;\n\n&lt;dict\\&gt;\n\n    &lt;key\\&gt;configedit\\&lt;/key\\&gt;\n\n    &lt;string\\&gt;-p filter.wavenetcloud.netsweeper.com:3431 -y\nnetsweeper_brand -f 958209 -n %devicename%@123-4567 -d 123-4567 -g nsw_pupil\\&lt;/string\\&gt;\n\n&lt;/dict\\&gt;\n\n&lt;/plist\\&gt;\n</code></pre> Notice LightspeedMDM requires the DFE code on the \"-n\" as well as the \"-d\" options, also note that device names will not show correctly if they have a space in the name.</p>","tags":["Apple","IOS","iPad","MacOS"]},{"location":"Apple/#meraki","title":"Meraki","text":"","tags":["Apple","IOS","iPad","MacOS"]},{"location":"Apple/#manual-ssl-installation","title":"Manual SSL Installation","text":"<p>To manually install the SSL Certificate see Apple support: Trust manually installed certificate</p>","tags":["Apple","IOS","iPad","MacOS"]},{"location":"Chromebook/","title":"Google Chromebook","text":""},{"location":"Chromebook/#requirements","title":"Requirements","text":"<p>Chromebooks simply require to be licenced within the Google Admin console, if they aren't licenced and they are stand-alone they can only be used on the filtering and the SSL Certifcate would need to be installed manually (Chromebook manaul SSL installation is not covered in this guide)</p>"},{"location":"Chromebook/#google-admin","title":"Google Admin","text":""},{"location":"Chromebook/#ssl-certificate","title":"SSL Certificate","text":"<p>Login to: Google Admin</p> <p>Go to Devices -&gt; Networks and then find the \"Certificates\" section and click on this section</p> <p></p> <p>On this Click the \"Add Certificate\"</p> <p></p> <p>Give the Certificate a name and click \"UPLOAD\" and browse to the certificate file to upload this. Make sure \"Enabled for Chromebook\" is ticked</p> <p></p>"},{"location":"Chromebook/#wagent","title":"Wagent","text":"<p>The ChromeOS Netsweeper wagent extension ID is: \"gehcmbonedocjpdjfemeklocmmpedmoj\" Chrome Wagent Store Page</p> <p>The below JSON should be amended and applied to the \"Policy for extensions\" section</p> <pre><code>{\n  \"NS_WAGENT_ARGS\": {\n    \"Value\": \"-w wavenetcloud.netsweeper.com -d nsagent-login.netsweeper.com -g {LOGIN_GUID} -L {LOGOUT_GUID} -i -l -v\"\n  },\n  \"NS_WAGENT_SOFTWARENAME\": {\n    \"Value\": \"Netsweeper Workstation Agent\"\n  }\n}\n</code></pre>"},{"location":"Chromebook/#client-filter","title":"Client Filter","text":"<p>The Chrome extension ID that is required by the onGuard (Client Filter) is: \u201ckdbgbpcphmnekmkhbcfmbdahceffhddn\u201d Chrome Client Filter Store Page</p> <p>The below JSON should be amended and applied to the \"Policy for extensions\" section</p> <pre><code>{\n   \"policyserver\": {\n      \"Value\": \"filter.wavenetcloud.netsweeper.com:3431\"\n   },\n   \"makeopts\": {\n      \"Value\": \"-y {BRAND} -f 923649 -g {nsw_group} -d {DFE-Code} -t 987\"\n   },\n   \"whitelist\": {\n      \"Value\": [\n         \"stylesheet://, 1\",\n         \"script://, 1\",\n         \"image://, 1\",\n         \"font://, 1\",\n         \"object://, 1\",\n         \"ping://, 1\",\n         \"csp_report://, 1\",\n         \"media://, 1\",\n         \"websocket://, 1\",\n         \"other://, 1\",\n         \"filesystem:, 1\"\n      ]\n   }\n}\n</code></pre>"},{"location":"Firewall-config/","title":"Firewall Configs","text":"<p>The preference for moving traffic to Netsweeper is via a GRE tunnel assuming the Firewall supports this, if not we have the option of using IPSEC</p> <p>The downsides to IPSEC are the overhead of encrypting the data, setting a FortiGate up to route all traffic via the IPSEC will cut off remote connections making the IPSEC only possible if you are onsite.</p> <p>We need to advise Netsweeper which type of tunnel we are using when onboarding the customer, though this can be changed later, changing an active tunnel will mean disrupting the filterring. </p> <p>Firewall Configs</p> <p>This is a Netsweeper only guide and does not cover other firewall security that should be applied.</p>","tags":["Fortigate"]},{"location":"Firewall-config/#fortigate","title":"FortiGate","text":"","tags":["Fortigate"]},{"location":"Firewall-config/#enable-advanced-routing","title":"Enable Advanced Routing","text":"","tags":["Fortigate"]},{"location":"Firewall-config/#gre-tunnel-configuration","title":"GRE Tunnel Configuration","text":"<p>This is done via the CLI and cannot be completed via the GUI, the details below are a guide and the highlighted items are the items that change from site to site.</p> <pre><code>config system gre-tunnel\nedit \"toNetsweeper\"\nset interface wan\nset remote-gw {Netsweeper IP}\nset local-gw {Customer IP}\nnext\nend\n\nconfig system interface\nedit \"toNetsweeper\"\nset vdom \"root\"\nset ip 172.16.0.73 255.255.255.255\nset allowaccess ping\nset type tunnel\nset remote-ip 172.16.0.74 255.255.255.252\nset snmp-index 12\nset interface wan\nnext\nend\n</code></pre>","tags":["Fortigate"]},{"location":"Firewall-config/#static-route-to-netsweeper","title":"Static Route to Netsweeper","text":"<p>Create a static route for 0.0.0.0/0 with the interface set to the \u201ctoNetsweeper\u201d interface.</p> <p></p>","tags":["Fortigate"]},{"location":"Firewall-config/#policy-route","title":"Policy Route","text":"<p>We need to create policy routes on the FortiGate for the following:</p> <p>TCP/UDP 443</p> <p>TCP/UDP 80</p> <p>This can be either completed via the CLI or GUI, the code is below</p> <p><pre><code>edit 0\nset input-device \"lan\"\nset srcaddr \"Lan\"\nset dstaddr \"all\"\nset protocol 6\nset start-port 443\nset end-port 443\nset gateway 172.16.0.74\nset output-device \"toNetsweeper\"\nnext\n\nedit 0\nset input-device \"lan\"\nset srcaddr \"Lan\"\nset dstaddr \"all\"\nset protocol 17\nset start-port 443\nset end-port 443\nset gateway 172.16.0.74\nset output-device \"toNetsweeper\"\nnext\n\nedit 0\nset input-device \"lan\"\nset srcaddr \"Lan\"\nset dstaddr \"all\"\nset protocol 6\nset start-port 80\nset end-port 80\nset gateway 172.16.0.74\nset output-device \"toNetsweeper\"\nnext\n\nedit 0\nset input-device \"lan\"\nset srcaddr \"Lan\"\nset dstaddr \"all\"\nset protocol 6\nset start-port 3431\nset end-port 3432\nset gateway 123.123.123.123\nset output-device \"wan\"\nnext\n\nend\n</code></pre> Here is the GUI setup, this shows TCP 443 for the others change the Protocol and Destination Ports</p> <p></p>","tags":["Fortigate"]},{"location":"Firewall-config/#firewall-policy","title":"Firewall Policy","text":"<p>We need at least 2 policies creating, the first is to disable QUIC TCP/UDP 80 &amp; 443 this should really already be implemented. The second rule is to allow HTTP(S) traffic from LAN to \u201ctoNetsweeper\u201d with NAT disabled.</p> <p>My preference for this rule would be to split this out per VLAN so egress traffic can be monitored per VLAN</p> <p></p> <p>Where onGuard is used we need to create a policy for TCP port 3431 &amp; 3432 from the LAN to WAN with a destination address of either the FQDN \u201cfilter.wavenetcloud.netsweeper.com\u201d or to the IP \u201c185.222.115.98\u201d this will ensure that no other proxy can get outbound traffic on these ports.</p> <p>For completeness a deny should be inserted for any HTTP(S) from LAN to WAN so in the event of a VPN failure web traffic stops.</p>","tags":["Fortigate"]},{"location":"Firewall-config/#watchguard","title":"WatchGuard","text":"<p>Coming soon</p>","tags":["Fortigate"]},{"location":"Netsweeper-webadmin/","title":"Netsweeper Webadmin","text":"","tags":["Netsweeper","Webadmin"]},{"location":"Netsweeper-webadmin/#logon-to-netsweeper-webadmin","title":"Logon to Netsweeper Webadmin","text":"<p>browse to: https://wavenetcloud.netsweeper.com/webadmin/start </p> <p></p> <p>If you don't have a logon account contact the helpdesk</p>","tags":["Netsweeper","Webadmin"]},{"location":"Netsweeper-webadmin/#groups-policies","title":"Groups &amp; Policies","text":"","tags":["Netsweeper","Webadmin"]},{"location":"Netsweeper-webadmin/#groups","title":"Groups","text":"<p>In Policies -&gt; groups if the groups haven\u2019t been created or we need additional groups and this is a basic school setup then click the \u201c+\u201d</p> <p></p> <p>On the group creation screen, we need to enter the group name, notice here we are appending the group name with the DFE code. We put the school name in the description to aid searching.</p> <p></p> <p>Once you have pressed submit the following screen will load. If not click the \"Policies\" option on the top bar</p> <p>Under \"General\" change the name to match the \"group name\" e.g. nsw_staff@000-0000</p> <p></p> <p>In this screen click \"List\" and then click on \"default\" or \"nsw_staff@00-0000\" this will load the \"default\" policy</p> <p></p> <p>Now Select \"Categories\" and change the drop down to one of the following:</p> <ul> <li>Wavenet - School</li> <li>Wavenet - School Teacher</li> <li>Wavenet - School Admin</li> </ul> <p></p> <p>Make sure you click the \"Submit\" on this screen.</p> <p>Now under \"URL/KEYWORD SHARED LISTS\" under \"Available Lists\" select the below:</p> <p>For Pupil</p> <ul> <li>Aruba Central</li> <li>Decryption</li> <li>Exceptions - Decrypt List</li> <li>Filter Bypass List</li> <li>Intune</li> <li>Inventry</li> <li>JAMF</li> <li>Legacy Selective Decryption</li> <li>LightspeedMDM</li> <li>NS Exceptions - Decrypt List</li> <li>NS Exceptions - Mac OS</li> <li>NS Exceptions - Windows</li> <li>RMM</li> <li>Selective Decryption</li> <li>Sophos</li> <li>System Allow List</li> <li>System Deny List</li> <li>System Wide Search Keywords</li> <li>System Wide Search Keywords2</li> </ul> <p>For Staff</p> <p>Select the above that we selected for Pupil and the following:</p> <ul> <li>Disney+</li> <li>Netflix</li> <li>School Admin</li> <li>Twitter</li> <li>Vimeo</li> <li>YouTube</li> </ul> <p>Now select the \"URL/KEYWORD LOCAL LIST\" here you can add allow / deny websites for the specific group</p> <p></p>","tags":["Netsweeper","Webadmin"]},{"location":"Netsweeper-webadmin/#clients","title":"Clients","text":"<p>\u201cPolicies\u201d -&gt; \u201cClients\u201d this is the local networks used by the schools click the \u201c+\u201d to add a new network Group \u2013 this should be the pupil groups Client Type \u2013 set this to \u201cNetwork Subnet\u201d Client Settings: Client Name \u2013 name@dfe-code e.g. wireless@123-4567 IP Address or Range \u2013 This should be the Network Address e.g. 10.1.2.0 Subnet Mask: this should be the subnet mask for the network e.g. 255.255.255.0</p> <p></p>","tags":["Netsweeper","Webadmin"]},{"location":"Netsweeper-webadmin/#lists","title":"Lists","text":"<p>In lists we can create 2 kinds of list \u201cLocal\u201d and \u201cShared\u201d lists, I would recommend creating \u201cShared\u201d lists as these can be re-used for other Policy Groups</p> <p>To Create a list click the \u201c+\u201d</p> <p></p> <p>On this next screen we need to name the list this should be either the trust name or DFE code and usage such as \u201callow\u201d or \u201cdeny\u201d e.g. \u201c123-4567 \u2013 allow\u201d so we can identify where lists are used or controlled by. Comments is not required but can be helpful in identifying how the list is used.</p> <p>List assignments this can be left blank but Don\u2019t tick \u201cSystem Wide List\u201d or \u201cFilter Bypass List\u201d</p> <p>Restrictions this forces the list to be a particular type e.g an allow list this can be left blank and the list used for multiple purposes. Though usually we would tick \u201callow\u201d, \u201cdeny\u201d etc.</p> <p>The \u201cAdd Sysop\u201d should be used to add any other people to view or manage the list.</p> <p></p>","tags":["Netsweeper","Webadmin"]},{"location":"Netsweeper-webadmin/#acounts","title":"Acounts","text":"<p>To create a user account for the end users go to \u201cAccounts\u201d -&gt; \u201cAccounts\u201d and click the \u201c+\u201d on the next screen select \u201cAdvanced\u201d</p> <p>Login Name</p> <p>The Login Name email address field is case sensitive</p> <p>Login Name \u2013 needs to be the email address of the user First name: Last name: Email Address \u2013 this should be the users email address Organization \u2013 This should be the school name Account Password \u2013 this should be complex and no longer than 15 characters Classification \u2013 should be \u201cSysop\u201d Account Template \u2013 this will vary depending on the site but generally this would be any of the \u201cCustomer\u201d prefixed group. Change password on login \u2013 tick this box</p> <p></p> <p>Once the user is created you can then go back in and select the \u201cGroups\u201d tab and assign to any groups the user should see.</p>","tags":["Netsweeper","Webadmin"]},{"location":"Netsweeper-webadmin/#wagent","title":"Wagent","text":"","tags":["Netsweeper","Webadmin"]},{"location":"Netsweeper-webadmin/#client-filer-onguard","title":"Client Filer (onGuard)","text":"","tags":["Netsweeper","Webadmin"]},{"location":"Netsweeper-webadmin/#reports","title":"Reports","text":"","tags":["Netsweeper","Webadmin"]},{"location":"Netsweeper-webadmin/#users","title":"Users","text":"","tags":["Netsweeper","Webadmin"]},{"location":"Netsweeper-webadmin/#directory-sync","title":"Directory Sync","text":"","tags":["Netsweeper","Webadmin"]},{"location":"Netsweeper-webadmin/#active-directory-sync","title":"Active Directory Sync","text":"","tags":["Netsweeper","Webadmin"]},{"location":"Netsweeper-webadmin/#entraid-sync-microsoft-graph","title":"EntraID Sync (Microsoft Graph)","text":"<p>Follow this Netsweeper guide to setup the EntraID sync</p>","tags":["Netsweeper","Webadmin"]},{"location":"SSL/","title":"SSL Certificate","text":"<p>The SSL Certifcate should be downloaded from: SSL Proxy Certificate</p> <p>You can scan the below QR code for manual installation on a mobile device:</p> <p></p>","tags":["SSL","Certificate"]},{"location":"Windows-AD/","title":"Windows Active Directory Setup","text":""},{"location":"Windows-AD/#windows-active-directory-sync","title":"Windows Active Directory Sync","text":""},{"location":"Windows-AD/#netsweeper-service-account","title":"Netsweeper Service Account","text":"<p>Create an account for the Netsweeper user, this user account only need to be a member of \u201cDomain Users\u201d and should NOT be a \u201cDomain Administrator\u201d</p> <p>First check the \u201cAdvanced Features\u201d is enabled under the View menu in Active Directory.</p> <p></p> <p>If needed create a new Organisational Unit for this user otherwise create this user account with other service accounts.</p> <p>Right click on the white space in the folder and select \u201cNew\u201d -&gt; \u201cUser\u201d</p> <p></p> <p>Fill out the form naming the account to fit in with the schools\u2019 naming conventions. Click \u201cNext\u201d when done.</p> <p></p> <p>Set a complex password and tick the \u201cPassword never expires\u201d box, then click \u201cNext\u201d</p> <p></p> <p>On the next screen, click \u201cFinish\u201d</p> <p></p> <p>Once we have created the user either double click on the user account or right click and select \u201cProperties\u201d</p> <p>When the screen loads you should the \u201cAttribute Editor\u201d tab, if not go back and make sure you enabled \u201cAdvanced Features\u201d under the view menu. Select the \u201cAttribute Editor\u201d tab.</p> <p></p> <p>In the \u201cAttribute Editor\" tab scroll down and find the entry \u201cdistinguishedName\u201d and click the \u201cView\u201d button. The value will look something like this: \u201cCN=svc netsweeper,OU=Netsweeper,DC=domain,DC=local\u201d make a note of this value Netsweeper requires this for the LDAP Sync.</p> <p></p>"},{"location":"Windows-AD/#create-filtering-groups","title":"Create Filtering Groups","text":"<p>To create the filtering groups go to the \u201cOrganisational Unit\u201d where you store Active Directory groups or create a new location. Right click in the white space on the right and select \u201cNew\u201d -&gt; \u201cGroup\u201d</p> <p></p> <p>The Group name should be set here with the prefix nsw_ So in the example below we have setup the filtering group for staff with the name nsw_staff</p> <p></p> <p>Once the groups have been created add the required users to the group, groups can be nested in here but be careful making sure a user doesn\u2019t end up being a member of multiple filtering groups.</p>"},{"location":"Windows-AD/#windows-group-policy","title":"Windows Group Policy","text":""},{"location":"Windows-AD/#deploying-ssl-certificate","title":"Deploying SSL Certificate","text":"<p>Before anything we need to grab a copy of the SSL certificate for Netsweeper this can be downloaded from:</p> <p>SSL Proxy Certificate</p> <p>Create a new Group Policy Object named something like \"SSL\"</p> <p></p> <p>Right click and \"Edit\" the new policy</p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p>"},{"location":"Windows-AD/#deploy-the-wagent","title":"Deploy the Wagent","text":"<p>The WAgent can be installed prior to going live with the filtering system. Unless we are doing a Netsweeper to Netsweeper migration</p> <p>In group policy management create a new group policy, setting the name to fit in with the schools group policy naming conventions.</p> <p></p> <p>In this example we call the group policy \u201cSoftware Deployment\u201d</p> <p></p> <p>Once created location the group policy and right click on this and select \u201cEdit\u201d</p> <p></p> <p>Once this opens browse to \u201cComputer Configuration\u201d -&gt; \u201cPolicies\u201d -&gt; \u201cSoftware Settings\u201d -&gt; \u201cSoftware installation\u201d!</p> <p></p> <p>Right click on the white space and select \u201cNew\u201d -&gt; \u201cPackage\u201d</p> <p></p> <p>Here browse to the UNC path of the share where the software is stored. In the below example we browse to the location \\DC01\\Software and select the MSI package named \u201cNetsweeper Workstation Agent - 4.40.54.54-windows.msi\u201d and click \u201cOpen\u201d</p> <p></p> <p></p> <p></p> <p></p> <p></p>"},{"location":"Windows-AD/#deploy-the-client-filter","title":"Deploy the Client Filter","text":"<p>nMonitor is the software required for the filtering with onGuard, this should be deployed when ready to \u201cGo Live\u201d</p> <p>In group policy management create a new group policy, setting the name to fit in with the schools group policy naming conventions.</p> <p></p> <p>In this example we call the group policy \u201cSoftware Deployment\u201d</p> <p></p> <p>Once created location the group policy and right click on this and select \u201cEdit\u201d</p> <p></p> <p>Once this opens browse to \u201cComputer Configuration\u201d -&gt; \u201cPolicies\u201d -&gt; \u201cSoftware Settings\u201d -&gt; \u201cSoftware installation\u201d!</p> <p></p> <p>Right click on the white space and select \u201cNew\u201d -&gt; \u201cPackage\u201d</p> <p></p> <p>Here browse to the UNC path of the share where the software is stored. In the below example we browse to the location \\DC01\\Software and select the MSI package named \u201cnMonitor Client \u2013 11.60.54.1 win64.msi\u201d and click \u201cOpen\u201d</p> <p></p> <p>Once this has been selected, and clicked \u201cOpen\u201d the next screen we need to change the default option from \u201cAssigned\u201d to \u201cAdvanced\u201d</p> <p></p> <p>When the option has been set to \u201cAdvanced\u201d click Ok. Then select the tab \u201cModifications\u201d on the screen that loads.</p> <p></p> <p>On the \u201cModifications\u201d screen click \u201cAdd\u201d and you should see the MST file, assuming you have stored this in the same location as the MSI installation file.</p> <p></p> <p>Once the MST is selected, click Ok.</p> <p>On the next screen, click OK again and this is now configured.</p> <p></p>"},{"location":"Windows-Intune/","title":"Windows Intune","text":"","tags":["Intune","Windows"]},{"location":"Windows-Intune/#netsweeper-groups","title":"Netsweeper Groups","text":"","tags":["Intune","Windows"]},{"location":"Windows-Intune/#entraid-sync","title":"EntraID Sync","text":"<p>Setup the EntraID Sync as per Netsweeper guide to setup the EntraID sync</p> <p>Conditional Access</p> <p>If you have conditional Access setup you will need to add the Netsweeper Webadmin IP Address to bypass MFA</p>","tags":["Intune","Windows"]},{"location":"windows-build-clients/","title":"Windows Build Clients","text":"<p>To create the Netsweeper Windows agents you need to be able to edit the MSI files, to do this you will need to install ORCA, below is the Microsoft link on how to do this:</p> <p>Installing ORCA</p>"},{"location":"windows-build-clients/#wagent-build-mst","title":"wagent build MST","text":"<p>Download the latest GA version from: Netsweeper Helpdesk</p> <p>Open Microsoft ORCA and open the WAGent.MSI, then go to \"Transform\" -&gt; \"New Transform\"</p> <p></p> <p>On the left select \"Property\" and we need to update the NS_WAGENT_ARGS line, with the following</p> <p><pre><code>-w wavenetcloud.netsweeper.com -d nsagent-login.netsweeper.com -s nsw -g {LOGON_GUID} -L {LOGOUT_GUID} -t 600 -i -l -v -F -S\n</code></pre> Change the LOGON and LOGOUT GUIDs with the GUID for the WAgent from the Netsweeper page \"Tools\" -&gt; \"Agent\"</p> <p></p> <p></p>"},{"location":"windows-build-clients/#client-filter-build-mst","title":"Client Filter build MST","text":"<p>Download the latest GA version from: Netsweeper Helpdesk</p> <p>Open Microsoft ORCA and open the WAGent.MSI, then go to \"Transform\" -&gt; \"New Transform\"</p> <p></p> <p>On the left select \"Property\" and we need to update the following lines CONFIGEDIT, NMONITOR_CONFIG, NUPDATE_ENABLED, with the following</p> <p></p> <p>CONFIGEDIT <pre><code>-p filter.wavenetcloud.netsweeper.com:3431 -y {BRAND_NAME} -f 923649 -i nsw -d {DFE-CODE} -c -s\n</code></pre></p> <p>NMONITOR_CONFIG <pre><code>--webadmin=https://wavenetcloud.netsweeper.com/webadmin/ --log=0 --ocr_disabled=0 --ocr_image_compare_disabled=0 --ocr_matched_category_compare=1 --ocr_disable_words_compare=0 --ocr_disable_input_compare=0 --ocr_timeout_recapture=5 --keylog_disabled=0 --keylog_buffer_size=1024 --keylog_timeout_send=1 --keylog_timeout_clear=30 --image_quality=50 --image_target_width=0 --image_target_height=0 --tray_disabled=0 --tray_menu_disabled=0\n</code></pre></p> <p>NUPDATE_ENABLED <pre><code>1\n</code></pre></p> <p>Once the settings have been set go to \"Transforms\" -&gt; \"Generate Transform\" and then save the MST file</p>"},{"location":"windows-standalone/","title":"Windows Standalone","text":""},{"location":"windows-standalone/#manual-ssl-installation","title":"Manual SSL Installation","text":"<p>Download the SSL Certificate: </p> <p>SSL Proxy Certificate</p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p>"},{"location":"windows-standalone/#manaul-wagent-installation","title":"Manaul wagent Installation","text":"<p>open a command prompt with Administrator privileges, this must be CMD and not Powershell.</p> <p>The command we need to run to install the software is (change the TRANSFORMS=\u2026 part to match the MST for the school):</p> <pre><code>msiexec /i \"wagent.msi\" /qn TRANSFORMS=\"123-4567 wagent transform filemst.mst\"\n</code></pre>"},{"location":"windows-standalone/#manual-client-filter-installation","title":"Manual Client Filter Installation","text":"<p>open a command prompt with Administrator privileges, this must be CMD and not Powershell.</p> <p>The command we need to run to install the software is (change the TRANSFORMS=\u2026 part to match the MST for the school):</p> <pre><code>msiexec /i \"nMonitor Client.msi\" /qn TRANSFORMS=\"123-4567 nMonitor transform filemst.mst\"\n</code></pre> <p>Once this is installed you will see the below icon in the system tray</p> <p></p>"}]}